{
  attributes: {
    "dataSource.category": "network",
    "dataSource.name": "F5 VPN",
    "dataSource.vendor": "F5"
  },
  patterns: {
    timestampPattern: "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z",
    logPattern: "F5VPN\\s+session_id=\"([^\"]+)\"\\s+user=\"([^\"]+)\"\\s+client_ip=\"([^\"]+)\"(?:\\s+start_time=\"([^\"]+)\")?(?:\\s+bytes_in=(\\d+))?(?:\\s+bytes_out=(\\d+))?(?:\\s+duration=\"([^\"]+)\")?\\s+event=\"([^\"]+)\"(?:\\s+reason=\"([^\"]+)\")?(?:\\s+device=\"([^\"]+)\")?\\s+message=\"([^\"]+)\""
  },
  formats: [
    {
      id: "f5_vpn_format",
      format: "$timestamp=timestampPattern$ $logPattern$"
    }
  ],
  mappings: {
    version: 1,
    mappings: [
      {
        predicate: "event = *",
        transformations: [
          {
            constant: {
              value: "4001",
              field: "class_uid"
            }
          },
          {
            constant: {
              value: "Network Activity",
              field: "class_name"
            }
          },
          {
            regex: {
              field: "session.uid",
              pattern: "logPattern",
              group: 1
            }
          },
          {
            regex: {
              field: "actor.user.name",
              pattern: "logPattern",
              group: 2
            }
          },
          {
            regex: {
              field: "src_endpoint.ip",
              pattern: "logPattern",
              group: 3
            }
          },
          {
            regex: {
              field: "start_time",
              pattern: "logPattern",
              group: 4
            }
          },
          {
            regex: {
              field: "traffic.bytes_in",
              pattern: "logPattern",
              group: 5
            }
          },
          {
            regex: {
              field: "traffic.bytes_out",
              pattern: "logPattern",
              group: 6
            }
          },
          {
            regex: {
              field: "duration",
              pattern: "logPattern",
              group: 7
            }
          },
          {
            regex: {
              field: "event_type",
              pattern: "logPattern",
              group: 8
            }
          },
          {
            regex: {
              field: "status_detail",
              pattern: "logPattern",
              group: 9
            }
          },
          {
            regex: {
              field: "device.type",
              pattern: "logPattern",
              group: 10
            }
          },
          {
            regex: {
              field: "message",
              pattern: "logPattern",
              group: 11
            }
          },
          {
            constant: {
              value: "1",
              field: "activity_id",
              predicate: "event_type = 'SESSION_START'"
            }
          },
          {
            constant: {
              value: "2",
              field: "activity_id",
              predicate: "event_type = 'SESSION_END'"
            }
          },
          {
            constant: {
              value: "3",
              field: "activity_id",
              predicate: "event_type = 'SESSION_DENIED'"
            }
          },
          {
            constant: {
              value: "99",
              field: "activity_id",
              predicate: "activity_id = null"
            }
          },
          {
            constant: {
              value: "Open",
              field: "activity_name",
              predicate: "activity_id = '1'"
            }
          },
          {
            constant: {
              value: "Close",
              field: "activity_name",
              predicate: "activity_id = '2'"
            }
          },
          {
            constant: {
              value: "Deny",
              field: "activity_name",
              predicate: "activity_id = '3'"
            }
          },
          {
            constant: {
              value: "Other",
              field: "activity_name",
              predicate: "activity_id = '99'"
            }
          },
          {
            constant: {
              value: "1",
              field: "severity_id",
              predicate: "event_type = 'SESSION_START'"
            }
          },
          {
            constant: {
              value: "1",
              field: "severity_id",
              predicate: "event_type = 'SESSION_END'"
            }
          },
          {
            constant: {
              value: "2",
              field: "severity_id",
              predicate: "event_type = 'SESSION_DENIED'"
            }
          },
          {
            constant: {
              value: "Informational",
              field: "severity",
              predicate: "severity_id = '1'"
            }
          },
          {
            constant: {
              value: "Medium",
              field: "severity",
              predicate: "severity_id = '2'"
            }
          }
        ]
      }
    ]
  }
}