{
  attributes: {
    "dataSource.category": "system",
    "dataSource.name": "Harness CI/CD",
    "dataSource.vendor": "Harness"
  },
  patterns: {
    timestampPattern: "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z",
    logPattern: "Harness\\s+pipelineId=\"([^\"]+)\"\\s+executionId=\"([^\"]+)\"(?:\\s+stage=\"([^\"]+)\")?(?:\\s+step=\"([^\"]+)\")?\\s+status=\"([^\"]+)\"(?:\\s+trigger=\"([^\"]+)\")?(?:\\s+initiator=\"([^\"]+)\")?(?:\\s+duration=\"([^\"]+)\")?(?:\\s+error=\"([^\"]+)\")?\\s+message=\"([^\"]+)\""
  },
  formats: [
    {
      id: "harness_format",
      format: "$timestamp=timestampPattern$ $logPattern$"
    }
  ],
  mappings: {
    version: 1,
    mappings: [
      {
        predicate: "status = *",
        transformations: [
          {
            constant: {
              value: "8001",
              field: "class_uid"
            }
          },
          {
            constant: {
              value: "DevOps Activity",
              field: "class_name"
            }
          },
          {
            regex: {
              field: "job.name",
              pattern: "logPattern",
              group: 1
            }
          },
          {
            regex: {
              field: "job.uid",
              pattern: "logPattern",
              group: 2
            }
          },
          {
            regex: {
              field: "stage",
              pattern: "logPattern",
              group: 3
            }
          },
          {
            regex: {
              field: "step",
              pattern: "logPattern",
              group: 4
            }
          },
          {
            regex: {
              field: "status",
              pattern: "logPattern",
              group: 5
            }
          },
          {
            regex: {
              field: "trigger_type",
              pattern: "logPattern",
              group: 6
            }
          },
          {
            regex: {
              field: "actor.user.name",
              pattern: "logPattern",
              group: 7
            }
          },
          {
            regex: {
              field: "duration",
              pattern: "logPattern",
              group: 8
            }
          },
          {
            regex: {
              field: "status_detail",
              pattern: "logPattern",
              group: 9
            }
          },
          {
            regex: {
              field: "message",
              pattern: "logPattern",
              group: 10
            }
          },
          {
            constant: {
              value: "1",
              field: "activity_id",
              predicate: "status = 'STARTED'"
            }
          },
          {
            constant: {
              value: "2",
              field: "activity_id",
              predicate: "status = 'SUCCEEDED'"
            }
          },
          {
            constant: {
              value: "3",
              field: "activity_id",
              predicate: "status = 'FAILED'"
            }
          },
          {
            constant: {
              value: "Deploy",
              field: "activity_name",
              predicate: "activity_id = '1'"
            }
          },
          {
            constant: {
              value: "Deploy",
              field: "activity_name",
              predicate: "activity_id = '2'"
            }
          },
          {
            constant: {
              value: "Deploy",
              field: "activity_name",
              predicate: "activity_id = '3'"
            }
          },
          {
            constant: {
              value: "1",
              field: "severity_id",
              predicate: "status = 'SUCCEEDED'"
            }
          },
          {
            constant: {
              value: "3",
              field: "severity_id",
              predicate: "status = 'FAILED'"
            }
          },
          {
            constant: {
              value: "1",
              field: "severity_id",
              predicate: "status = 'STARTED'"
            }
          }
        ]
      }
    ]
  }
}